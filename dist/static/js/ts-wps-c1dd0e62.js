var N=function(){return(N=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function E(e,n,t,r){return new(t||(t=Promise))(function(i,u){function a(c){try{l(r.next(c))}catch(o){u(o)}}function d(c){try{l(r.throw(c))}catch(o){u(o)}}function l(c){var o;c.done?i(c.value):(o=c.value,o instanceof t?o:new t(function(p){p(o)})).then(a,d)}l((r=r.apply(e,n||[])).next())})}function x(e,n){var t,r,i,u,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return u={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(l){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){a=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(o[0]===6&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(e,a)}catch(p){o=[6,p],r=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([l,c])}}}var D=function(){function e(){}return e.add=function(n){e.HANDLE_LIST.push(n),window.addEventListener("message",n,!1)},e.remove=function(n){var t=e.HANDLE_LIST.indexOf(n);t>=0&&e.HANDLE_LIST.splice(t,1),window.removeEventListener("message",n,!1)},e.empty=function(){for(;e.HANDLE_LIST.length;)window.removeEventListener("message",e.HANDLE_LIST.shift(),!1)},e.parse=function(n){try{return typeof n=="object"?n:n&&JSON.parse(n)}catch{return n}},e.HANDLE_LIST=[],e}();function le(e){if(!e)return!1;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function oe(e){return{}.toString.call(e)==="[object Function]"}var Y,q,be,fe,re,Te={origin:""};function Ee(e,n){Te[e]=n}function xe(e){return Te[e]}function $(e){var n=xe("origin");return!!function(t,r){return t!==r&&(t.replace(/www\./i,"").toLowerCase()!==r.replace(/www\./i,"").toLowerCase()||(t.match("www.")?void 0:(Ee("origin",r),!1)))}(n,e.origin)&&!0}(function(e){e.Spreadsheet="s",e.Writer="w",e.Presentation="p",e.Pdf="f"})(Y||(Y={})),function(e){e.unknown="unknown",e.spreadsheet="s",e.writer="w",e.presentation="p",e.pdf="f"}(q||(q={})),function(e){e.wps="w",e.et="s",e.presentation="p",e.pdf="f"}(be||(be={})),function(e){e.nomal="nomal",e.simple="simple"}(fe||(fe={})),function(e){e[e.requestFullscreen=1]="requestFullscreen",e[e.exitFullscreen=0]="exitFullscreen"}(re||(re={}));var Ie,K,U,de=(Ie=0,function(){return Ie+=1}),me=function(e,n,t){t===void 0&&(t=!0);var r=typeof n=="string"?document.querySelector(n):n;if(!K){var i=(function d(l){var c=l.clientHeight,o=l.clientWidth;c!==0||o!==0||U?c===0&&o===0||!U||(U.disconnect(),U=null):window.ResizeObserver&&(U=new ResizeObserver(function(p){d(l)})).observe(l),K.style.cssText+="height: "+c+"px; width: "+o+"px"}).bind(null,r);(K=document.createElement("iframe")).classList.add("web-office-iframe");var u={id:"office-iframe",src:e,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"clipboard-read; clipboard-write"};for(var a in r?(u.style="width: "+r.clientWidth+"px; height: "+r.clientHeight+"px;",t&&window.addEventListener("resize",i)):((r=document.createElement("div")).classList.add("web-office-default-container"),function(d){var l=document.createElement("style");document.head.appendChild(l);var c=l.sheet;c.insertRule(d,c.cssRules.length)}(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100%; height: 100%; left: 0; top: 0;}"),document.body.appendChild(r),u.style="position: fixed; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;"),u)K.setAttribute(a,u[a]);r.appendChild(K),K.destroy=function(){K.parentNode.removeChild(K),K=null,window.removeEventListener("resize",i),U&&(U.disconnect(),U=null)}}return K},V=function(e){me().contentWindow&&me().contentWindow.postMessage(JSON.stringify(e),xe("origin"))};function _e(e,n,t){return new Promise(function(r){var i=de(),u=function(a){if(!$(a)){var d=D.parse(a.data);d.eventName===t&&d.msgId===i&&(r(d.data),D.remove(u))}};D.add(u),V({data:e,msgId:i,eventName:n})})}var De=function(e){return _e(e,"wps.jssdk.api","wps.api.reply")},ve=function(e){return _e(e,"api.basic","api.basic.reply")},L={idMap:{}};function je(e){return E(this,void 0,void 0,function(){var n,t,r,i,u,a,d,l,c,o;return x(this,function(p){switch(p.label){case 0:return $(e)?[2]:(n=D.parse(e.data),t=n.eventName,r=n.callbackId,i=n.data,r&&(u=L.idMap[r])?(a=u.split(":"),d=a[0],l=a[1],t==="api.callback"&&L[d]&&L[d][l]?[4,(o=L[d][l]).callback.apply(o,i.args)]:[3,2]):[3,2]);case 1:c=p.sent(),V({result:c,callbackId:r,eventName:"api.callback.reply"}),p.label=2;case 2:return[2]}})})}var Pe=function(e){return E(void 0,void 0,void 0,function(){function n(){return Object.keys(L.idMap).find(function(p){return L.idMap[p]===r+":"+t})}var t,r,i,u,a,d,l,c,o;return x(this,function(p){switch(p.label){case 0:return t=e.prop,r=e.parentObjId,[4,Ce([i=e.value])];case 1:return u=p.sent(),a=u[0],d=u[1],e.value=a[0],l=Object.keys(d)[0],c=L[r],i===null&&c&&c[t]&&((o=n())&&delete L.idMap[o],delete c[t],Object.keys(c).length||delete L[r],Object.keys(L.idMap).length||D.remove(je)),l&&(Object.keys(L.idMap).length||D.add(je),L[r]||(L[r]={}),L[r][t]={callbackId:l,callback:d[l]},(o=n())&&delete L.idMap[o],L.idMap[l]=r+":"+t),[2]}})})},ge=function(e,n,t,r){return E(void 0,void 0,void 0,function(){var i,u,a,d,l,c,o,p;return x(this,function(w){switch(w.label){case 0:return i=de(),d=new Promise(function(h,v){u=h,a=v}),l={},n.args?[4,Ce(n.args)]:[3,2];case 1:c=w.sent(),o=c[0],p=c[1],n.args=o,l=p,w.label=2;case 2:return e!=="api.setter"?[3,4]:[4,Pe(n)];case 3:w.sent(),w.label=4;case 4:return function(h){var v=h[0],k=h[1];typeof(v=N({},v)).data=="function"&&(v.data=v.data()),k(),V(v)}([{eventName:e,data:n,msgId:i},function(){var h=this,v=function(k){return E(h,void 0,void 0,function(){var y,A,S;return x(this,function(b){switch(b.label){case 0:return $(k)?[2]:(y=D.parse(k.data)).eventName==="api.callback"&&y.callbackId&&l[y.callbackId]?[4,l[y.callbackId].apply(l,y.data.args)]:[3,2];case 1:A=b.sent(),V({result:A,eventName:"api.callback.reply",callbackId:y.callbackId}),b.label=2;case 2:return y.eventName===e+".reply"&&y.msgId===i&&(y.error?((S=new Error("")).stack=y.error+`
`+t,r&&r(),a(S)):u(y.result),D.remove(v)),[2]}})})};return D.add(v),d}]),[2,d]}})})};function Ce(e){return E(this,void 0,void 0,function(){var n,t,r,i,u,a,d,l,c,o,p;return x(this,function(w){switch(w.label){case 0:n={},t=[],r=e.slice(0),w.label=1;case 1:return r.length?(i=void 0,[4,r.shift()]):[3,13];case 2:return(u=w.sent())&&u.done?[4,u.done()]:[3,4];case 3:w.sent(),w.label=4;case 4:if(!le(i))return[3,11];for(d in i={},a=[],u)a.push(d);l=0,w.label=5;case 5:return l<a.length?(c=a[l],o=u[c],/^[A-Z]/.test(c)?o&&o.done?[4,o.done()]:[3,7]:[3,8]):[3,10];case 6:w.sent(),w.label=7;case 7:o&&o.objId?o={objId:o.objId}:typeof o=="function"&&(p=de(),n[p]=o,o={callbackId:p}),w.label=8;case 8:i[c]=o,w.label=9;case 9:return l++,[3,5];case 10:return[3,12];case 11:u&&u.objId?i={objId:u.objId}:typeof u=="function"&&u.objId===void 0?(p=de(),n[p]=u,i={callbackId:p}):i=u,w.label=12;case 12:return t.push(i),[3,1];case 13:return[2,[t,n]]}})})}var Fe=function(e,n){n===void 0&&(n=!0);var t=N({},e),r=t.headers,i=r===void 0?{}:r,u=t.subscriptions,a=u===void 0?{}:u,d=t.mode,l=d===void 0?fe.nomal:d,c=t.commonOptions,o=i.backBtn,p=o===void 0?{}:o,w=i.shareBtn,h=w===void 0?{}:w,v=i.otherMenuBtn,k=v===void 0?{}:v,y=function(g,s){g.subscribe&&typeof g.subscribe=="function"&&(g.callback=s,a[s]=g.subscribe,n&&delete g.subscribe)};if(y(p,"wpsconfig_back_btn"),y(h,"wpsconfig_share_btn"),y(k,"wpsconfig_other_menu_btn"),k.items&&Array.isArray(k.items)){var A=[];k.items.forEach(function(g,s){switch(g===void 0&&(g={}),g.type){case"export_img":g.type=1,g.callback="export_img";break;case"export_pdf":g.type=1,g.callback="export_pdf";break;case"save_version":g.type=1,g.callback="save_version";break;case"about_wps":g.type=1,g.callback="about_wps";break;case"split_line":g.type=2;break;case"custom":g.type=3,y(g,"wpsconfig_other_menu_btn_"+s),A.push(g)}}),A.length&&(He||Ve)&&(k.items=A)}t.url=t.url||t.wpsUrl;var S=[];if((l===fe.simple||c&&c.isShowTopArea===!1)&&S.push("simple","hidecmb"),t.debug&&S.push("debugger"),t.url&&S.length&&(t.url=t.url+(t.url.indexOf("?")>=0?"&":"?")+S.join("&")),c&&(c.isParentFullscreen||c.isBrowserViewFullscreen)&&(document.addEventListener("fullscreenchange",ue),document.addEventListener("webkitfullscreenchange",ue),document.addEventListener("mozfullscreenchange",ue)),t.wordOptions&&(t.wpsOptions=t.wordOptions),t.excelOptions&&(t.etOptions=t.excelOptions),t.pptOptions&&(t.wppOptions=t.pptOptions),typeof a.print=="object"){var b="wpsconfig_print";typeof a.print.subscribe=="function"&&(a[b]=a.print.subscribe,t.print={callback:b},a.print.custom!==void 0&&(t.print.custom=a.print.custom)),delete a.print}return typeof a.exportPdf=="function"&&(a[b="wpsconfig_export_pdf"]=a.exportPdf,t.exportPdf={callback:b},delete a.exportPdf),t.commandBars&&ce(t.commandBars,!1),N(N({},t),{subscriptions:a})},We=function(e){var n=N({},e),t=n.appId,r=n.fileId,i=n.officeType,u=n.fileToken,a=n.endpoint,d=n.customArgs,l=d===void 0?"":d;if(!Object.values(Y).includes(i))throw Error("[WebOfficeSDK.init] officeType属性值错误，可选值参考WebOfficeSDK.OfficeType: "+JSON.stringify(Y));var c=u?1:0,o={token:""};if(typeof u=="string"?o.token=u:le(u)&&(o=N({tokenData:o},u)),c&&!o.token)return n;if(typeof a!="string")throw Error("[WebOfficeSDK.init] endpoint期望为字符串");if(a&&!a.startsWith("http"))return n;if(n.url=a+"/office/"+i+"/"+r+"?_w_appid="+t+"&_w_tokentype="+c,le(l)){var p=Object.entries(l).map(function(w){var h=w[0],v=w[1];return h+"="+encodeURIComponent(v)}).join("&");n.url=n.url+"&"+p}return N({},n)},Be=function(e){e===void 0&&(e="");var n="";if(!n&&e){var t=e.toLowerCase();t.indexOf("/office/s/")!==-1&&(n=q.spreadsheet),t.indexOf("/office/w/")!==-1&&(n=q.writer),t.indexOf("/office/p/")!==-1&&(n=q.presentation),t.indexOf("/office/f/")!==-1&&(n=q.pdf)}if(!n){var r=e.match(/[\?&]type=([a-z]+)/)||[];n=be[r[1]]||""}return n};function ce(e,n){n===void 0&&(n=!0);var t=e.map(function(r){var i=r.attributes;if(!Array.isArray(i)){var u=[];for(var a in i)if(i.hasOwnProperty(a)){var d={name:a,value:i[a]};u.push(d)}r.attributes=u}return r});return n&&V({data:t,eventName:"setCommandBars"}),t}var Re=window.navigator.userAgent.toLowerCase(),He=/Android|webOS|iPhone|iPod|BlackBerry|iPad/i.test(Re),Ve=function(){try{return window._parent.location.search.indexOf("from=wxminiprogram")!==-1}catch{return!1}}();function ue(){var e={status:re.requestFullscreen},n=document,t=n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement;e.status=t?re.requestFullscreen:re.exitFullscreen,V({data:e,eventName:"fullscreenchange"})}var Me=function(){L.idMap={}};var X=0,pe=new Set;function ae(e){return X+=1,!e&&function(n){pe.forEach(function(t){return t(n)})}(X),X}function se(){var e=new Error("");return(e.stack||e.message||"").split(`
`).slice(2).join(`
`)}function Ke(e,n){var t,r=this,i=n.Events,u=n.Enum,a=n.Props,d=a[0],l=a[1],c={objId:X};switch(function h(v,k,y){for(var A=k.slice(0),S=function(){var b=A.shift();!b.alias&&~Se.indexOf(b.prop)&&A.push(N(N({},b),{alias:b.prop+"Async"})),Object.defineProperty(v,b.alias||b.prop,{get:function(){var g=this,s=b.cache===1,f=s&&this["__"+b.prop+"CacheValue"];if(!f){var O=se(),M=ae(s),m=function(){for(var I,_=[],j=0;j<arguments.length;j++)_[j]=arguments[j];return b.caller!==void 0?function C(W,B,F){for(var P=B.slice(0),J=function(){var T=P.shift();!T.alias&&~Se.indexOf(T.prop)&&P.push(N(N({},T),{alias:T.prop+"Async"})),Object.defineProperty(W,T.alias||T.prop,{get:function(){var ee=this,ne=T.cache===1,ye=ne&&this["__"+T.prop+"CacheValue"];if(!ye){var ke=se(),Le=ae(ne),G=function(){for(var te,Oe=[],ie=0;ie<arguments.length;ie++)Oe[ie]=arguments[ie];return T.caller!==void 0?C(te={objId:ae()},F[T.caller],F):te={},Q(G,te,"api.caller",{obj:G,args:Oe,parentObjId:W.objId,objId:te.objId,prop:T.prop},ke),te};return G.objId=-1,T.getter!==void 0&&(G.objId=Le,C(G,F[T.getter],F)),Q(W,G,"api.getter",{parentObjId:W.objId,objId:G.objId,prop:T.prop},ke,function(){delete ee["__"+T.prop+"CacheValue"]}),ne&&(this["__"+T.prop+"CacheValue"]=G),G}return ye},set:function(ee){var ne=se();return Q(W,{},"api.setter",{value:ee,parentObjId:W.objId,objId:-1,prop:T.prop},ne)}})};P.length;)J()}(I={objId:ae()},y[b.caller],y):I={},Q(m,I,"api.caller",{obj:m,args:_,parentObjId:v.objId,objId:I.objId,prop:b.prop},O),I};return m.objId=-1,b.getter!==void 0&&(m.objId=M,h(m,y[b.getter],y)),Q(v,m,"api.getter",{parentObjId:v.objId,objId:m.objId,prop:b.prop},O,function(){delete g["__"+b.prop+"CacheValue"]}),s&&(this["__"+b.prop+"CacheValue"]=m),m}return f},set:function(g){var s=se();return Q(v,{},"api.setter",{value:g,parentObjId:v.objId,objId:-1,prop:b.prop},s)}})};A.length;)S()}(c,d,l),c.Events=i,c.Enum=u,e.Enum=c.Enum,e.Events=c.Events,e.Props=a,Be(e.url)){case q.writer:e.WordApplication=e.WpsApplication=function(){return c};break;case q.spreadsheet:e.ExcelApplication=e.EtApplication=function(){return c};break;case q.presentation:e.PPTApplication=e.WppApplication=function(){return c};break;case q.pdf:e.PDFApplication=function(){return c}}e.Application=c,e.Free=function(h){return ge("api.free",{objId:h},"")},e.Stack=c.Stack=(t=function(h){e&&e.Free(h)},function(){var h=[],v=function(k){h.push(k)};return pe.add(v),{End:function(){t(h),pe.delete(v)}}});var o={};D.add(function(h){return E(r,void 0,void 0,function(){var v,k,y,A,S;return x(this,function(b){switch(b.label){case 0:return $(h)?[2]:(v=D.parse(h.data)).eventName==="api.event"&&v.data?(k=v.data,y=k.eventName,A=k.data,(S=o[y])?[4,S(A)]:[3,2]):[3,2];case 1:b.sent(),b.label=2;case 2:return[2]}})})}),c.Sub={};var p=function(h){var v=i[h];Object.defineProperty(c.Sub,v,{set:function(k){o[v]=k,V({eventName:"api.event.register",data:{eventName:v,register:!!k,objId:X+=1}})}})};for(var w in i)p(w)}var Se=["ExportAsFixedFormat","GetOperatorsInfo","ImportDataIntoFields","ReplaceText","ReplaceBookmark","GetBookmarkText","GetComments"];function Q(e,n,t,r,i,u){var a,d=(e.done?e.done():Promise.resolve()).then(function(){return a||(a=ge(t,r,i,u)),a});n.done=function(){return d},n.then=function(l,c){return r.objId>=0?(n.then=null,n.catch=null,d.then(function(){l(n)}).catch(function(o){return c(o)})):d.then(l,c)},n.catch=function(l){return d.catch(l)},n.Destroy=function(){return ge("api.free",{objId:n.objId},"")}}var H={},R=null,Z={fileOpen:"fileOpen",tabSwitch:"tabSwitch",fileSaved:"fileSaved",fileStatus:"fileStatus",fullscreenChange:"fullscreenChange",error:"error",stage:"stage"},z={getToken:"api.getToken",onToast:"event.toast",onHyperLinkOpen:"event.hyperLinkOpen",getClipboardData:"api.getClipboardData"};function Ne(e,n,t,r,i,u,a){var d=this;t===void 0&&(t={}),D.add(function(l){return E(d,void 0,void 0,function(){var c,o,p,w,h,v,k,y,A,S,b,g,s,f,O,M,m,I,_;return x(this,function(j){switch(j.label){case 0:return $(l)?[2]:(c=D.parse(l.data),o=c.eventName,p=o===void 0?"":o,w=c.data,h=w===void 0?null:w,v=c.url,k=v===void 0?null:v,["wps.jssdk.api"].indexOf(p)!==-1?[2]:p!=="ready"?[3,1]:(i.apiReadySended&&function(C){var W=[];Object.keys(H).forEach(function(B){H[B].forEach(function(F){var P=B;C.off(P,F),W.push({handle:F,eventName:P})}),delete H[B]}),W.forEach(function(B){var F=B.eventName,P=B.handle;R==null||R.ApiEvent.AddApiEventListener(F,P)})}(n),V({eventName:"setConfig",data:N(N({},t),{version:e.version})}),e.tokenData&&e.setToken(N(N({},e.tokenData),{hasRefreshTokenConfig:!!t.refreshToken})),e.iframeReady=!0,[3,15]));case 1:return p!=="error"?[3,2]:(n.emit(Z.error,h),[3,15]);case 2:return p!=="open.result"?[3,3]:(((m=h==null?void 0:h.fileInfo)===null||m===void 0?void 0:m.officeVersion)!==void 0&&(e.mainVersion=h.fileInfo.officeVersion),n.emit(Z.fileOpen,h),[3,15]);case 3:return p!=="api.scroll"?[3,4]:(window.scrollTo(h.x,h.y),[3,15]);case 4:if(p!==z.getToken)return[3,9];y={token:!1},j.label=5;case 5:return j.trys.push([5,7,,8]),[4,i.refreshToken()];case 6:return y=j.sent(),[3,8];case 7:return A=j.sent(),[3,8];case 8:return V({eventName:z.getToken+".reply",data:y}),[3,15];case 9:if(p!==z.getClipboardData)return[3,14];S={text:"",html:""},j.label=10;case 10:return j.trys.push([10,12,,13]),[4,i.getClipboardData()];case 11:return S=j.sent(),[3,13];case 12:return b=j.sent(),[3,13];case 13:return V({eventName:z.getClipboardData+".reply",data:S}),[3,15];case 14:p===z.onToast?i.onToast(h):p===z.onHyperLinkOpen?i.onHyperLinkOpen(h):p==="stage"?n.emit(Z.stage,h):p==="event.callback"?(g=h.eventName,s=h.data,f=g,g==="fullScreenChange"&&(f=Z.fullscreenChange),g==="file.saved"&&(f=Z.fileStatus),(!((I=t.commonOptions)===null||I===void 0)&&I.isBrowserViewFullscreen||!((_=t.commonOptions)===null||_===void 0)&&_.isParentFullscreen)&&f==="fullscreenchange"&&(O=s.status,M=s.isDispatchEvent,t.commonOptions.isBrowserViewFullscreen?function(C,W,B,F){C===0?W.style="position: static; width: "+B.width+"; height: "+B.height:C===1&&(W.style="position: absolute; width: 100%; height: 100%"),F&&function(P){["fullscreen","fullscreenElement"].forEach(function(T){Object.defineProperty(document,T,{get:function(){return!!P.status},configurable:!0})});var J=new CustomEvent("fullscreenchange");document.dispatchEvent(J)}({status:C})}(O,u,a,M):t.commonOptions.isParentFullscreen&&function(C,W,B){var F=document.querySelector(B),P=F&&F.nodeType===1?F:W;if(C===0){var J=document,T=J.exitFullscreen||J.mozCancelFullScreen||J.msExitFullscreen||J.webkitCancelFullScreen||J.webkitExitFullscreen;T.call(document)}else if(C===1){var ee=P.requestFullscreen||P.mozRequestFullScreen||P.msRequestFullscreen||P.webkitRequestFullscreen;ee.call(P)}}(O,u,t.commonOptions.isParentFullscreen)),n.emit(f,s)):p==="api.ready"&&Ke(e,h),j.label=15;case 15:return typeof r[p]=="function"&&r[p](e,k||h),[2]}})})})}function he(e){return new Promise(function(n){var t=function(r){$(r)||D.parse(r.data).eventName===e&&(n(),D.remove(t))};D.add(t)})}function we(e){var n,t=this;e===void 0&&(e={}),R&&R.destroy();try{var r=Fe(e),i=r.subscriptions,u=i===void 0?{}:i,a=r.mount,d=a===void 0?null:a,l=r.url,c=r.refreshToken,o=r.onToast,p=r.onHyperLinkOpen,w=r.getClipboardData;Ee("origin",(l.match(/https*:\/\/[^\/]+/g)||[])[0]);var h=me(l,d),v=he("ready"),k=he("open.result"),y=he("api.ready"),A=d?{width:d.clientWidth+"px",height:d.clientHeight+"px"}:{width:"100vw",height:"100vh"};delete r.mount,l&&delete r.url,delete r.subscriptions;var S=(n=n||Object.create(null),{on:function(s,f){(n[s]||(n[s]=[])).push(f)},off:function(s,f){n[s]&&n[s].splice(n[s].indexOf(f)>>>0,1)},emit:function(s,f){(n[s]||[]).slice().map(function(O){O(f)}),(n["*"]||[]).slice().map(function(O){O(s,f)})}}),b={apiReadySended:!1},g=function(s,f,O){return E(t,void 0,void 0,function(){return x(this,function(M){switch(M.label){case 0:return function(m,I,_){if(H[m]){var j=!!H[m].find(function(C){return C===I});return j&&_==="off"?(S.off(m,I),H[m]=H[m].filter(function(C){return C!==I}),!!H[m].length||(H[m]=void 0,!1)):(j||_!=="on"||(H[m].push(I),S.on(m,I)),!0)}return _==="on"?(H[m]=[],H[m].push(I),!1):_==="off"||void 0}(s,f,O)?[3,2]:[4,v];case 1:M.sent(),function(m,I){var _=m.eventName,j=m.type,C=m.handle;I==="on"?S.on(_,C):S.off(_,C),j==="base.event"&&V({eventName:"basic.event",data:{eventName:_,action:I}})}(function(m,I){var _=m,j="base.event";switch(_){case Z.fileSaved:_="fileStatus";break;case Z.fullscreenChange:_="fullscreenchange";break;case"error":case"fileOpen":j="callback.event"}return{eventName:_,type:j,handle:I}}(s,f),O),M.label=2;case 2:return[2]}})})};return R={url:l,iframe:h,version:"1.1.20",iframeReady:!1,tokenData:null,commandBars:null,tabs:{getTabs:function(){return E(this,void 0,void 0,function(){return x(this,function(s){switch(s.label){case 0:return[4,v];case 1:return s.sent(),[2,ve({api:"tab.getTabs"})]}})})},switchTab:function(s){return E(this,void 0,void 0,function(){return x(this,function(f){switch(f.label){case 0:return[4,v];case 1:return f.sent(),[2,ve({api:"tab.switchTab",args:{tabKey:s}})]}})})}},setCooperUserColor:function(s){return E(this,void 0,void 0,function(){return x(this,function(f){switch(f.label){case 0:return[4,v];case 1:return f.sent(),[2,ve({api:"setCooperUserColor",args:s})]}})})},setToken:function(s){return E(this,void 0,void 0,function(){return x(this,function(f){switch(f.label){case 0:return[4,v];case 1:return f.sent(),R.tokenData=s,V({eventName:"setToken",data:s}),[2]}})})},ready:function(){return E(this,void 0,void 0,function(){return x(this,function(s){switch(s.label){case 0:return b.apiReadySended?[3,2]:[4,k];case 1:s.sent(),b.apiReadySended=!0,V({eventName:"api.ready"}),s.label=2;case 2:return[4,y];case 3:return s.sent(),[2,new Promise(function(f){return setTimeout(function(){return f(R==null?void 0:R.Application)},0)})]}})})},destroy:function(){H={},h.destroy(),D.empty(),R=null,pe=new Set,X=0,document.removeEventListener("fullscreenchange",ue),Me()},save:function(){return E(this,void 0,void 0,function(){return x(this,function(s){switch(s.label){case 0:return[4,v];case 1:return s.sent(),[2,De({api:"save"})]}})})},setCommandBars:function(s){return E(this,void 0,void 0,function(){return x(this,function(f){switch(f.label){case 0:return[4,v];case 1:return f.sent(),ce(s),[2]}})})},updateConfig:function(s){return s===void 0&&(s={}),E(this,void 0,void 0,function(){return x(this,function(f){switch(f.label){case 0:return[4,v];case 1:return f.sent(),s.commandBars?[4,ce(s.commandBars)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[2]}})})},executeCommandBar:function(s){return E(this,void 0,void 0,function(){return x(this,function(f){switch(f.label){case 0:return[4,v];case 1:return f.sent(),ce([{cmbId:s,attributes:[{name:"click",value:!0}]}]),[2]}})})},on:function(s,f){return E(this,void 0,void 0,function(){return x(this,function(O){return[2,this.ApiEvent.AddApiEventListener(s,f)]})})},off:function(s,f){return E(this,void 0,void 0,function(){return x(this,function(O){return[2,this.ApiEvent.RemoveApiEventListener(s,f)]})})},ApiEvent:{AddApiEventListener:function(s,f){return E(this,void 0,void 0,function(){return x(this,function(O){switch(O.label){case 0:return[4,g(s,f,"on")];case 1:return[2,O.sent()]}})})},RemoveApiEventListener:function(s,f){return E(this,void 0,void 0,function(){return x(this,function(O){switch(O.label){case 0:return[4,g(s,f,"off")];case 1:return[2,O.sent()]}})})}}},function(s,f,O,M,m,I){f&&oe(f)&&(m.refreshToken=f,s.refreshToken={eventName:z.getToken}),I&&oe(I)&&(m.getClipboardData=I,s.getClipboardData={eventName:z.getClipboardData}),O&&oe(O)&&(m.onToast=O,s.onToast={eventName:z.onToast}),M&&oe(M)&&(m.onHyperLinkOpen=M,s.onHyperLinkOpen={eventName:z.onHyperLinkOpen})}(r,c,o,p,b,w),Ne(R,S,r,u,b,h,A),r.fileToken&&(le(r.fileToken)?R.setToken(N({},r.fileToken)):R.setToken({token:r.fileToken})),R}catch{}}function Ae(e){var n=N({},e);if(n.url)throw Error("[WebOfficeSDK.init] 不支持传递url，请使用appId、fileId、officeType、fileToken等参数初始化！");if(!n.appId||!n.fileId||!n.officeType)throw Error("[WebOfficeSDK.init] appId、fileId、officeType为必选项！");return n.endpoint=n.endpoint||"https://o.wpsgo.com",we(We(n))}var ze=Object.freeze({__proto__:null,listener:Ne,config:we,createApp:Ae,get OfficeType(){return Y}});window.WPS=ze;const qe={config:we,init:Ae,OfficeType:Y};export{qe as W};
