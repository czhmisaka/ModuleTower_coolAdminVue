import{i as u,g as te}from"./index-1e0489aa.js";import"./store-acb3382e.js";import{u as G}from"./index-eba40255.js";import{_ as oe}from"./form-btn.vue_vue_type_script_setup_true_lang-3388a6a4.js";import{j as X}from"./lodash-es-74a5df03.js";import{d as E,t as le,q as ne,X as t,o as H,c as ae,a as D,e,K as l,O as m,F as ce,n as se,J as re}from"./@vue.runtime-core-0029b467.js";import{j as U,r as B,u as x}from"./@vue.reactivity-b2e38c7a.js";import{O as w}from"./@vue.shared-ccdbf9b9.js";import{_ as pe}from"./_plugin-vue_export-helper-c27b6911.js";import{a as F,b as ie}from"./element-plus-7426fe99.js";import"./@vue.runtime-dom-592c53ed.js";import"./@vueuse.core-bf8dfe85.js";import"./@vueuse.shared-501e3e4b.js";import"./mitt-b509fb6d.js";import"./axios-f6771985.js";import"./nprogress-5ff42f71.js";import"./chardet-cfd7d38a.js";import"./pinia-6d4e9d4f.js";import"./monaco-editor-f913c445.js";import"./vue-echarts-8be4a346.js";import"./resize-detector-a5205554.js";import"./echarts-eea5b079.js";import"./tslib-54e39b60.js";import"./zrender-ecf5ed03.js";import"./vue-router-6b15fa8a.js";import"./mockjs-597bdf6e.js";import"./vue-aac48648.js";import"./dayjs-20b85df8.js";import"./@element-plus.icons-vue-c499527b.js";import"./@popperjs.core-c75af06c.js";import"./@ctrl.tinycolor-f8748455.js";import"./async-validator-8a4f889d.js";import"./memoize-one-297ddbcb.js";import"./escape-html-f47942fe.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui.dom-4390772d.js";import"./@floating-ui.core-1d013f45.js";import"./@floating-ui.utils-1e4a7d10.js";const ue={class:"select-user__inner"},me={class:"btns"},de=E({name:"select-user"}),_e=E({...de,props:{modelValue:{type:Array,default:()=>[]},isDisabled:Boolean,prop:String,scope:null,disabled:Boolean},emits:["update:modelValue"],setup(K,{emit:I}){const M=K,N=I,{service:_,refs:k,setRefs:z}=G(),R=u.useForm(),f=U({status:[{label:"å¯ç”¨",value:1,type:"success"},{label:"ç¦ç”¨",value:0,type:"danger"}]}),b=u.useTable({contextMenu:[],columns:[{type:"selection",width:60,reserveSelection:!0},{prop:"headImg",label:"å¤´åƒ",component:{name:"cl-avatar"},minWidth:100},{prop:"username",label:"æ‰‹æœºå·",minWidth:120},{prop:"name",label:"å§“å",minWidth:150},{prop:"departmentName",label:"éƒ¨é—¨åç§°",minWidth:150},{label:"çŠ¶æ€",prop:"status",minWidth:100,dict:f.status},{label:"åˆ›å»ºæ—¶é—´",prop:"createTime",sortable:"desc",minWidth:160}]}),C=u.useCrud({service:_.base.sys.user,async onRefresh(c,{next:o}){const s=await o(c);v.value.push(...s.list.map(d=>d.id)),r.value.forEach(d=>{var i,g;const y=(i=b.value)==null?void 0:i.data.find(W=>W.id==d.id);y&&((g=b.value)==null||g.toggleRowSelection(y,!0))})}});async function j(c){var o;return(o=C.value)==null?void 0:o.refresh(c)}const n=B(!1),a=B([]),r=B([]),h=U({page:1,size:10}),$=le(()=>{const{page:c,size:o}=h;return a.value.slice((c-1)*o,c*o)}),v=B([]);function V(c){const o=Array.from(new Set(v.value));r.value=r.value.filter(s=>!o.includes(s.id)).concat(...c)}function A(){n.value=!0,v.value=[],r.value=X(a.value),se(()=>{j({size:10})})}function S(){n.value=!1}function O(){a.value=X(r.value||[]),S()}async function Y(){var c;await((c=C.value)==null?void 0:c.refresh({page:1,size:1e4}).then(o=>{a.value=o.list})),S()}function q(){const c=k.table.selection.map(o=>o.id);a.value=a.value.filter(o=>(k.table.toggleRowSelection(o,!1),!c.find(s=>s==o.id)))}return ne(a,(c=[])=>{var o;N("update:modelValue",c.map(s=>s.id)),(o=R.value)==null||o.validateField(M.prop)},{deep:!0}),(c,o)=>{var L;const s=t("el-button"),d=t("cl-table"),y=t("el-pagination"),i=t("cl-row"),g=t("cl-crud"),W=t("cl-refresh-btn"),P=t("cl-select"),p=t("cl-filter"),T=t("cl-flex1"),Q=t("cl-search-key"),Z=t("cl-pagination"),ee=t("cl-dialog");return H(),ae(ce,null,[D("div",ue,[D("div",me,[e(s,{type:"success",onClick:A},{default:l(()=>[m("æ·»åŠ ")]),_:1}),e(s,{type:"danger",disabled:((L=x(k).table)==null?void 0:L.selection.length)==0,onClick:q},{default:l(()=>[m("ç§»é™¤")]),_:1},8,["disabled"])]),e(g,{padding:"0"},{default:l(()=>[e(d,{data:$.value,ref:x(z)("table"),"auto-height":!1},null,8,["data"]),e(i,{type:"flex",align:"middle",justify:"end",style:{marginTop:"10px"}},{default:l(()=>[e(y,{"current-page":h.page,"onUpdate:currentPage":o[0]||(o[0]=J=>h.page=J),"page-size":h.size,total:a.value.length,background:"",layout:"total, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])]),_:1})]),_:1})]),e(ee,{modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=J=>n.value=J),width:"1200px",title:"é€‰æ‹©ç”¨æˆ·"},{footer:l(()=>[e(s,{onClick:S},{default:l(()=>[m("å–æ¶ˆ")]),_:1}),e(s,{type:"success",onClick:O},{default:l(()=>[m("é€‰æ‹©")]),_:1})]),default:l(()=>[e(g,{ref_key:"Crud",ref:C,padding:"0"},{default:l(()=>[e(i,null,{default:l(()=>[e(W),e(s,{type:"primary",onClick:Y},{default:l(()=>[m("å…¨é€‰")]),_:1}),e(p,{label:"çŠ¶æ€"},{default:l(()=>[e(P,{options:f.status,prop:"status",width:120},null,8,["options"])]),_:1}),e(T),e(Q,{placeholder:"æœç´¢æ˜µç§°"})]),_:1}),e(i,null,{default:l(()=>[e(d,{ref_key:"Table",ref:b,"auto-height":!1,onSelectionChange:V},null,512)]),_:1}),e(i,null,{default:l(()=>[D("span",null,"å·²é€‰ "+w(r.value.length)+" äºº",1),e(T),e(Z)]),_:1})]),_:1},512)]),_:1},8,["modelValue"])],64)}}});const fe=pe(_e,[["__scopeId","data-v-c5661527"]]),be={style:{padding:"0 10px"}},he=E({name:"demo-crud"}),ot=E({...he,setup(K){const{service:I,refs:M,setRefs:N}=G(),{dict:_}=te(),k=U({status:[{label:"å¯ç”¨",value:1},{label:"ç¦ç”¨",type:"danger",value:0}]}),z=U({wages:0}),R=u.useCrud({service:I.test,async onRefresh(n,{next:a}){const r=await a(n);Object.assign(z,r.subData)}},n=>{n.refresh({})}),f=u.useUpsert({dialog:{height:"600px",width:"1000px"},items:[{type:"tabs",props:{type:"card",labels:[{label:"åŸºç¡€",value:"base"},{label:"é€‰æ‹©",value:"select"},{label:"å…¶ä»–",value:"other"}]}},{label:"å¤´åƒ",prop:"avatar",group:"base",component:{name:"cl-upload"}},{label:"è´¦å·",group:"base",prop:"account",component:{name:"el-input"}},()=>{var n;return{label:"å¯†ç ",group:"base",prop:"password",hidden:((n=f.value)==null?void 0:n.mode)=="update",component:{name:"el-input",props:{type:"password"}}}},{prop:"user",group:"base",component:{name:"cl-form-card",props:{label:"ç”¨æˆ·ä¿¡æ¯ï¼ˆå¤šå±‚çº§å±•ç¤ºï¼‰"}},children:[{label:"å§“å",prop:"name",required:!0,component:{name:"el-input"}},{label:"å­˜æ¬¾",prop:"wages",component:{name:"el-input-number"}}]},{label:"çœå¸‚åŒº",prop:"pca",group:"base",component:{name:"cl-distpicker"}},{label:"",prop:"userIds",group:"select",props:{labelWidth:"0px"},required:!0,component:{vm:fe}},{label:"å·¥ä½œ",prop:"occupation",group:"other",component:{name:"el-tree-select",props:{data:_.get("occupation"),checkStrictly:!0}}},{label:"èº«ä»½è¯ç…§ç‰‡",prop:"idCardPic",group:"other",component:{name:"cl-upload",props:{isSpace:!0,size:[200,300]}}}],plugins:[u.setFocus("account")],onInfo(n,{next:a,done:r}){r(n)},onSubmit(n,{next:a,close:r,done:h}){a(n)},onOpened(n){var a;((a=f.value)==null?void 0:a.mode)!="info"&&F.info("ç¼–è¾‘ä¸­")},onClose(n,a){var r;if(((r=f.value)==null?void 0:r.mode)=="update"&&n=="close")return ie.confirm("è¿˜æ²¡å¡«å®Œï¼Œç¡®å®šå…³é—­ä¸ï¼Ÿ","æç¤º",{type:"warning"}).then(()=>{a(),F.info("å¥½å§")}).catch(()=>{F.success("è¯·ç»§ç»­ç¼–è¾‘")});a()}}),b=u.useTable({columns:[{type:"selection",width:60},{label:"å±•å¼€",type:"expand",prop:"detail",width:60},{label:"å¤´åƒ",prop:"avatar",width:100,component:{name:"cl-image",props:{size:40}}},{label:"å§“å",prop:"name",minWidth:120},{label:"æ‰‹æœºå·",prop:"phone",minWidth:140,search:{component:{name:"el-input",props:{placeholder:"æœç´¢æ‰‹æœºå·"}}}},{label:"è´¦å·",prop:"account",minWidth:150},{label:"å­˜æ¬¾(å…ƒ)",prop:"wages",minWidth:150,sortable:"desc"},{label:"å·¥ä½œ",prop:"occupation",dict:_.get("occupation"),dictColor:!0,minWidth:150,dictAllLevels:!0,search:{component:{name:"cl-select",props:{options:_.get("occupation")}}}},{label:"çŠ¶æ€",orderNum:2,prop:"status",minWidth:100,component:{name:"cl-switch"}},{label:"å‡ºç”Ÿå¹´æœˆ",orderNum:1,minWidth:165,prop:"createTime",sortable:"custom",search:{component:e(t("cl-date-picker"),{type:"date","value-format":"YYYY-MM-DD",placeholder:"æœç´¢æ—¥æœŸ"},null)}},{type:"op",width:320,buttons({scope:n}){return["info","edit","delete",{label:"è‡ªå®šä¹‰",onClick(){F.info(`ä»–æ˜¯ï¼š${n.row.name}`)}}]}}]});function C(){return["åˆè®¡","",...M.columnCustom.summary(z)]}const j=u.useAdvSearch({items:[{label:"å§“å",prop:"name",component:{name:"el-input",props:{clearable:!0}}},{label:"æ‰‹æœºå·",prop:"phone",component:{name:"el-input",props:{clearable:!0}}},{label:"å·¥ä½œ",prop:"occupation",hook:{bind:"string"},component:{name:"el-select",options:_.get("occupation")}}]});return u.useSearch({items:[{label:"å§“å",prop:"name",component:{name:"el-input",props:{clearable:!0}}}]}),(n,a)=>{const r=t("cl-refresh-btn"),h=t("cl-add-btn"),$=t("cl-multi-delete-btn"),v=t("cl-select"),V=t("cl-filter"),A=t("cl-flex1"),S=t("cl-import-btn"),O=t("cl-export-btn"),Y=t("cl-column-custom"),q=t("cl-search-key"),c=t("cl-adv-btn"),o=t("cl-row"),s=t("el-descriptions-item"),d=t("el-descriptions"),y=t("cl-table"),i=t("cl-pagination"),g=t("cl-upsert"),W=t("cl-adv-search"),P=t("cl-crud");return H(),re(P,{ref_key:"Crud",ref:R},{default:l(()=>[e(o,null,{default:l(()=>{var p,T;return[e(r),e(h),e($),e(oe),e(V,{label:"çŠ¶æ€ç­›é€‰"},{default:l(()=>[e(v,{options:k.status,prop:"status",width:120},null,8,["options"])]),_:1}),e(V,{label:"å·¥ä½œï¼ˆå­—å…¸ï¼‰"},{default:l(()=>[e(v,{options:x(_).get("occupation"),prop:"occupation",width:120},null,8,["options"])]),_:1}),e(A),e(S,{template:"/ç”¨æˆ·å¯¼å…¥æ¨¡ç‰ˆ.xlsx"}),e(O,{columns:(p=x(b))==null?void 0:p.columns},null,8,["columns"]),e(Y,{columns:(T=x(b))==null?void 0:T.columns,ref:x(N)("columnCustom")},null,8,["columns"]),e(q,{placeholder:"æœç´¢å§“åã€æ‰‹æœºå·",width:250}),e(c)]}),_:1}),e(o,null,{default:l(()=>[e(y,{ref_key:"Table",ref:b,"show-summary":"","summary-method":C},{"column-detail":l(({scope:p})=>[D("div",be,[e(d,{border:"",column:3},{default:l(()=>[e(s,{label:"ID"},{default:l(()=>[m(w(p.row.id),1)]),_:2},1024),e(s,{label:"å§“å"},{default:l(()=>[m(w(p.row.name),1)]),_:2},1024),e(s,{label:"å­˜æ¬¾"},{default:l(()=>[m(w(p.row.wages),1)]),_:2},1024),e(s,{label:"å‡ºç”Ÿå¹´æœˆ"},{default:l(()=>[m(w(p.row.createTime),1)]),_:2},1024)]),_:2},1024)])]),"column-wages":l(({scope:p})=>[D("span",null,w(p.row.wages)+"ðŸ¤‘",1)]),_:1},512)]),_:1}),e(o,null,{default:l(()=>[e(A),e(i)]),_:1}),e(g,{ref_key:"Upsert",ref:f},null,512),e(W,{ref_key:"AdvSearch",ref:j},null,512)]),_:1},512)}}});export{ot as default};
